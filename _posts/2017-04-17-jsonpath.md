---
layout: post
title:  JSONPath usage in PostgreSQL
date:   2017-04-17 00:55
description: Example of querying using JSONPath usage in PostgreSQL
categories: development
published: false
---

Creating table:
```sql
create table my_table (
  title varchar,
  number integer,
  my_array jsonb
);

insert into my_table (title, number, my_array)
  values
  ('not expected', 6, '[{"min": 1, "max": 5}, {"min": 7, "max": 10}]'::jsonb),
  ('expected', 7, '[{"min": 1, "max": 5}, {"min": 7, "max": 10}]'::jsonb);
```

Usage example:
```sql
select *
  from my_table
 where JSON_EXISTS(my_array, '$[*] ? (@.min >= $x && $x < @.max)' PASSING number AS x);
```

TODO:

```json
$.[?(@.min < 3 && 3 <= @.max)]

[
    {
        "min": 1,
        "max": 5
    },
    {
        "min": 7,
        "max": 10
    }
]
```

Tests:
https://github.com/postgrespro/sqljson/commit/76b757944181a9747083872dde2e0efb0f160b9f
https://github.com/postgrespro/sqljson/blob/76b757944181a9747083872dde2e0efb0f160b9f/src/test/regress/expected/sql_json.out
